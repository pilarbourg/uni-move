<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="../css/studentLife.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  </head>
  <body>
    <nav class="navbar">
      <h1 class="logo">
        <img
          src="../assets/svgs/logo.svg"
          style="width: 36px; height: 36px"
        />UniMove
      </h1>

      <ul class="menu">
        <li class="dropdown">
          <a href="#">Universities</a>
          <ul class="dropdown-content">
            <li><a href="universidades.html">Search on Map</a></li>
            <li><a href="searchByDegree.html">Search by Degree</a></li>
          </ul>
        </li>

        <li class="dropdown">
          <a href="#">Moving</a>
          <ul class="dropdown-content">
            <li><a href="mapaapartamentos.html">Apartments</a></li>
          </ul>
        </li>

        <li class="dropdown">
          <a href="#">Students</a>
          <ul class="dropdown-content">
            <li><a href="studentLife.html">Study Section</a></li>
          </ul>
        </li>

        <li class="dropdown">
          <a href="#">Health</a>
          <ul class="dropdown-content">
            <li><a href="biomedical.html">Health</a></li>
            <li><a href="mapclinics.html">Clinical Maps</a></li>
          </ul>
        </li>
      </ul>

      <div class="nav-right">
        <a href="../index.html">
          <img src="../assets/svgs/home.svg" class="home-button"
        /></a>

        <li class="user-section">
          <span id="user-name" style="font-weight: bold; color: #5a7c99"></span>
          <button id="logout" class="boton" style="display: none">
            <img src="../assets/svgs/logout.svg" />
          </button>
        </li>
      </div>
    </nav>

    <section class="hero">
      <h2>Study Section</h2>
    </section>

    <main>
      <div class="tab">
        <button class="tablinks" onclick="openSubpage(event, 'Universities')">
          Find Local Libraries
        </button>
        <button class="tablinks" onclick="openSubpage(event, 'Degrees')">
          Pomodoro Timer
        </button>
        <button class="tablinks" onclick="openSubpage(event, 'Events')">
          Upcoming Events
        </button>
      </div>

      <div id="Universities" class="tabcontent"> 
        <h3>Libraries</h3> 
        <div class="libraries-container"> 
          <ul id="library-list"></ul> 
          <div class="libraries-map" id="librariesMap"></div> 
        </div> 
      </div>

      <div id="Degrees" class="tabcontent">
        <h3>Pomodoro Timer</h3>
        <div id="pomodoro-root" class="pomodoro-root">
          <div class="pomodoro-left">
            <div class="pomodoro-mode" id="p-mode">Focus</div>
            <div class="pomodoro-time" id="p-time">25:00</div>
          </div>

          <div class="pomodoro-right">
            <div class="pomodoro-controls">
              <button id="p-start" class="btn">Start</button>
              <button id="p-pause" class="btn" disabled>Pause</button>
              <button id="p-reset" class="btn">Reset</button>
              <button id="p-skip" class="btn">Skip</button>
            </div>

            <div class="pomodoro-config">
              <label
                >Focus
                <input
                  type="number"
                  id="p-focus-min"
                  min="1"
                  max="120"
                  value="25"
              /></label>
              <label
                >Break
                <input
                  type="number"
                  id="p-break-min"
                  min="1"
                  max="60"
                  value="5"
              /></label>
              <label
                >Auto-start <input type="checkbox" id="p-auto" checked
              /></label>
            </div>
          </div>
        </div>
      </div>

      <div id="Events" class="tabcontent">
        <h3>Upcoming Events in Madrid</h3>
        <div class="libraries-container">
          <ul id="event-list"></ul>
          <div class="events-calendar" id="eventsCalendar"></div>
        </div>
      </div>

    </main>

    <footer class="site-footer">
      <div class="footer-content">
        <div class="footer-brand">
          <img src="../assets/svgs/logo.svg" alt="MotivSMA Logo" />
          <span>UniMove</span>
        </div>
        <div class="footer-links">
          <a href="#">About</a>
          <a href="#">Privacy Policy</a>
          <a href="#">Contact</a>
        </div>
        <div class="footer-copy">
          <p>
            &copy; 2025 UniMove | Built with ❤️ for students around the world
          </p>
        </div>
      </div>
    </footer>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="../js/mapLibraries.js"></script>
    <script src="../js/eventsMadrid.js"></script>
    <script>
      function openSubpage(evt, title) {
        var i, tabcontent, tablinks;

        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
          tabcontent[i].style.display = "none";
        }

        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }

        document.getElementById(title).style.display = "block";
        evt.currentTarget.className += " active";
      }

      document.addEventListener("DOMContentLoaded", () => {
        document.querySelector(".tablinks").click();
      });
      
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const startBtn = document.getElementById("p-start");
        const pauseBtn = document.getElementById("p-pause");
        const resetBtn = document.getElementById("p-reset");
        const skipBtn = document.getElementById("p-skip");

        const modeEl = document.getElementById("p-mode");
        const timeEl = document.getElementById("p-time");

        const focusInput = document.getElementById("p-focus-min");
        const breakInput = document.getElementById("p-break-min");
        const autoCheckbox = document.getElementById("p-auto");
        const countEl = document.getElementById("p-count");

        let timer = null;
        let mode = "focus";
        let remaining = focusInput.value * 60;
        let endTime = null;
        let running = false;
        let completedFocus = 0;

        function format(sec) {
          const m = Math.floor(sec / 60);
          const s = sec % 60;
          return `${String(m).padStart(2, "0")}:${String(s).padStart(2, "0")}`;
        }

        function updateUI() {
          timeEl.textContent = format(remaining);
          modeEl.textContent = mode === "focus" ? "Focus" : "Break";
          startBtn.disabled = running;
          pauseBtn.disabled = !running;
          countEl.textContent = `Completed focus sessions: ${completedFocus}`;
        }

        function start() {
          if (running) return;
          running = true;

          endTime = Date.now() + remaining * 1000;

          timer = setInterval(() => {
            remaining = Math.round((endTime - Date.now()) / 1000);

            if (remaining <= 0) {
              clearInterval(timer);
              running = false;
              remaining = 0;
              updateUI();

              if (mode === "focus") {
                completedFocus++;
                mode = "break";
                remaining = breakInput.value * 60;
              } else {
                mode = "focus";
                remaining = focusInput.value * 60;
              }

              updateUI();
              if (autoCheckbox.checked) start();
            }

            updateUI();
          }, 250);

          updateUI();
        }

        function pause() {
          running = false;
          clearInterval(timer);
          remaining = Math.round((endTime - Date.now()) / 1000);
          updateUI();
        }

        function reset() {
          pause();
          mode = "focus";
          remaining = focusInput.value * 60;
          completedFocus = 0;
          updateUI();
        }

        function skip() {
          pause();
          if (mode === "focus") {
            completedFocus++;
            mode = "break";
            remaining = breakInput.value * 60;
          } else {
            mode = "focus";
            remaining = focusInput.value * 60;
          }
          updateUI();
          if (autoCheckbox.checked) start();
        }

        startBtn.onclick = start;
        pauseBtn.onclick = pause;
        resetBtn.onclick = reset;
        skipBtn.onclick = skip;

        updateUI();
      });
    </script>
  </body>
</html>
